<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="KBfEthUSZQCRbWviYR5cAUjNkvYqSP7RTLNR02OK">
    <meta name="base_url" content="public">

    <style>
        :root {
            --primary_color: #502f8f;
            --primary_color_hover: #502f8fcc;
        }
        .invoice-calculations, .tax-summary {
            display: flex;
            flex-direction: column;
            padding-left: 20px;
            }
            
            .hr {
                margin-top: 0rem;
                margin-bottom: 0rem;

                border: 0;
                border-top: 1px solid rgba(0, 0, 0, .1);
            }
            .container {
            display: flex;
            }

            .labels {
            flex: 0 0 100px; /* Adjust the width as needed */
            }

            .values {
            flex: 1;
            }

    </style>

    <!-- Title -->
    <title>HiFi Salon</title>

    <!-- Favicon -->
    <link href="public/storage/images/app/favicon.png" rel="icon" type="image/png">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>

    <!-- Icons -->
    <link rel="stylesheet" href="assets/vendor/fonts/materialdesignicons.css"/>
    <!-- CSS -->
    <link href="public/includes/css/nucleo.css" rel="stylesheet">
    <link rel="stylesheet" href="public/includes/css/core.css" class="template-customizer-core-css"/>
    <link rel="stylesheet" href="assets/vendor/css/rtl/theme-default.css" class="template-customizer-theme-css"/>
    <link href="public/includes/css/all.min.css" rel="stylesheet">
    <link href="public/includes/css/sweetalert2.scss">
    <link href="public/includes/css/jquery.timepicker.css" rel="stylesheet">

    <link rel="stylesheet" href="assets/vendor/css/pages/app-invoice.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@5.9.55/css/materialdesignicons.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css"
          href="https://cdn.datatables.net/v/bs4/jszip-2.5.0/dt-1.10.21/b-1.6.2/b-flash-1.6.2/b-html5-1.6.2/b-print-1.6.2/datatables.min.css"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    <script src="public/includes/js/jquery-3.5.1.js"></script>
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.css' rel='stylesheet'/>
    <!-- Argon CSS -->
    <link href="public/includes/css/argon.css" rel="stylesheet">
    <!-- <link href="public/includes/css/mystyle.css" rel="stylesheet"> -->
    <link href="public/includes/css/invoice/invoice-create.css" rel="stylesheet">
    <link href="public/includes/css/invoice/invoice-preview.css" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
    <!-- html2pdf CDN link -->
    
</head>

<body class="">
<div class="preload">
    <img src="public/storage/images/app/loader.gif" class="loader" alt="">
</div>
<div class="for-loader">
    <form id="logout-form" action="public/logout" method="POST" style="display: none;">
        <input type="hidden" name="_token" value="5O57DdIfZRvjAFgpQy1mzNGXw26aW2G9AGIdnel7">
    </form>
    <nav class="navbar navbar-vertical fixed-left navbar-expand-md navbar-light bg-white" id="sidenav-main">
        <div id="navbar-left"></div>
    </nav>

    <div class="main-content">
        <div id="navbar-top"></div>

        <div class="header pt-7"
             style="background-image: url(public/storage/images/app/bg_img.jpg); background-size: cover; background-position: center center;">
            <span class="mask bg-gradient-dark opacity-7"></span>
            <div class="container-fluid">
                <div class="header-body">
                    <div class="row align-items-center py-4 pb-7">
                        <div class="col-lg-6 col-7">
                            <nav aria-label="breadcrumb" class="d-none d-md-inline-block">
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Content wrapper -->
        <div class="content-wrapper">
            <!-- Content -->

            <div class="container-xxl flex-grow-1 container-p-y">
                <div class="row invoice-preview">
                    <!-- Invoice -->
                    <div class="col-xl-9 col-md-8 col-12 mb-md-0 mb-4">
                        <div class="align-center">
                            <div id="receipt" class="card receipt">
                                <div class="recept-body">
                                    <img id="customLogo" class="center-image" alt="Logo" src="https://i.ibb.co/YRXpXDR/Whats-App-Image-2023-07-28-at-9-30-21-PM.jpg" style="width: 125px; height: auto;">
                                    <div style="text-align: center;" id="storeName"></div>
                                    <div style="text-align: center;" id="storeAddress"></div>
                                    <table style="border-top: none;">
                                        <tbody>
                                            <tr>
                                                <th colspan="4" class="description" style="text-align: center;">
                                                    Tax Invoice
                                                </th>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td colspan="2" class="title">Customer:</td>
                                                <td colspan="2" class="title-value custName"></td>
                                            </tr>
                                            <tr>
                                                <td colspan="2" class="description">Phone No:</td>
                                                <td colspan="2" class="description custMobile"></td>
                                            </tr>
                                            <tr>
                                                <td colspan="2" class="description">Bill No:</td>
                                                <td colspan="2" class="description invoiceNumber"></td>
                                            </tr>
                                            <tr>
                                                <td colspan="2" class="description">Date: </td>
                                                <td colspan="2" class="description invoiceDate"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <thead>
                                            <tr>
                                                <th class="description">Services</th>
                                                <th class="quantity">Qty</th>
                                                <th class="rate">Rate</th>
                                                <th class="price">Amount</th>
                                            </tr>
                                        </thead>
                                        <tbody class="preview-items">
                                            
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody class="discountSummary">
                                            <tr>
                                                <td colspan="2" class="description">Basic Sales</td>
                                                <td colspan="2" class="price basicSales"></td>
                                            </tr>
                                            <tr>
                                                <td colspan="3" class="description discountCoupons">10% Special Discount</td>
                                                <td colspan="1" class="price couponDiscount">0.00</td>
                                            </tr>
                                            <tr>
                                                <td colspan="2" class="description">Mem. Discount</td>
                                                <td colspan="2" class="price membershipDiscount">0.00</td>
                                            </tr>
                                            <tr>
                                                <td colspan="2" class="description">Sub Total</td>
                                                <td colspan="2" class="price subTotal">0.00</td>
                                            </tr>
                                            <tr class="previewGst">
                                                
                                            </tr>
                                            <tr>
                                                <th colspan="2" class="description">Net Amount</th>
                                                <th colspan="2" class="price netAmount">0.00</th>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody class="netTotal">
                                            <tr>
                                                <td colspan="2" class="description">Net Total</td>
                                                <td colspan="2" class="price netAmount">0.00</td>
                                            </tr>
                                            <tr>
                                                <td colspan="2" class="description">Round(Off)</td>
                                                <td colspan="2" class="price roundOff">0.00</td>
                                            </tr>
                                            <tr>
                                                <th colspan="2" class="description">Bill Amount</th>
                                                <th colspan="2" class="price billAmount">0.00</th>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td colspan="2" class="description">Tender Amount</td>
                                                <td colspan="2" class="price">0.00</td>
                                            </tr>
                                            <tr>
                                                <td colspan="2" class="description">Change Amount</td>
                                                <td colspan="2" class="price">0.00</td>
                                            </tr>
                                            <tr>
                                                <td colspan="2" class="description">Paid Through</td>
                                                <td colspan="2" class="description price paymentMethod"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody class="taxSummary">
                                            <tr>
                                                <th colspan="4" class="description">Tax Summary</th>
                                            </tr>
                                            
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td colspan="4" class="description" style="text-align: justify;">
                                                    <span class="store-info">We are expanding our salon network. Intrested in owning a salon in an unrepresented area? 
                                                    Please write to us for franchised buisiness oppertunities</span>
                                                    <br> Mail: <span class="custCareEmail"></span>
                                                    <br> Call: <span class="storeCareNo"></span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td colspan="4" class="description">
                                                    GSTIN: <span class="gstTin"></span>
                                                    <br>In case of any suggestions/compliants
                                                    <br> Mail: <span class="custCareEmail"></span>
                                                    <br> Customer Care: <span class="custCareNo"></span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /Invoice -->

                    <!-- Invoice Actions -->
                    <div class="col-xl-3 col-md-4 col-12 invoice-actions">
                        <div class="card" style="position: sticky; top: 20px; z-index: 1000;">
                            <div class="card-body">
                                <button
                                    class="btn btn-primary d-grid w-100 mb-3"
                                    data-bs-toggle="offcanvas"
                                    data-bs-target="#sendInvoiceOffcanvas"
                                >
                                    <span class="d-flex align-items-center justify-content-center text-nowrap"
                                    ><i class="mdi mdi-send-outline scaleX-n1-rtl me-1"></i>Send Invoice</span>
                                </button>
                                <button id="btnDownloadInvoive" class="btn btn-outline-secondary d-grid w-100 mb-3">Download</button>
                                <button id="btnPrintInvoive" class="btn btn-outline-secondary d-grid w-100 mb-3">Print</button>
                                <a href="./app-invoice-edit.html"
                                   class="btn btn-outline-secondary d-grid w-100 mb-3">
                                    Edit Invoice
                                </a>
                                <button id="btnCancelInvoive" class="btn btn-outline-secondary d-grid w-100 mb-3">Cancel Invoice</button>
                                <!-- <button
                                    class="btn btn-success d-grid w-100"
                                    data-bs-toggle="offcanvas"
                                    data-bs-target="#addPaymentOffcanvas"
                                >
                                    <span class="d-flex align-items-center justify-content-center text-nowrap"
                                    ><i class="mdi mdi-currency-usd me-1"></i>Add Payment</span>
                                </button> -->
                            </div>
                        </div>
                    </div>
                    <!-- /Invoice Actions -->
                </div>

                <!-- Offcanvas -->
                <!-- Send Invoice Sidebar -->
                <div class="offcanvas offcanvas-end" id="sendInvoiceOffcanvas" aria-hidden="true">
                    <div class="offcanvas-header mb-3">
                        <h5 class="offcanvas-title">Send Invoice</h5>
                        <button
                                type="button"
                                class="btn-close text-reset"
                                data-bs-dismiss="offcanvas"
                                aria-label="Close"></button>
                    </div>
                    <div class="offcanvas-body flex-grow-1">
                        <form>
                            <div class="form-floating form-floating-outline mb-4">
                                <input
                                        type="text"
                                        class="form-control"
                                        id="invoice-from"
                                        value="shelbyComapny@email.com"
                                        placeholder="company@email.com"/>
                                <label for="invoice-from">From</label>
                            </div>
                            <div class="form-floating form-floating-outline mb-4">
                                <input
                                        type="text"
                                        class="form-control"
                                        id="invoice-to"
                                        value="qConsolidated@email.com"
                                        placeholder="company@email.com"/>
                                <label for="invoice-to">To</label>
                            </div>
                            <div class="form-floating form-floating-outline mb-4">
                                <input
                                        type="text"
                                        class="form-control"
                                        id="invoice-subject"
                                        value="Invoice of purchased Admin Templates"
                                        placeholder="Invoice regarding goods"/>
                                <label for="invoice-subject">Subject</label>
                            </div>
                            <div class="form-floating form-floating-outline mb-4">
                  <textarea class="form-control" name="invoice-message" id="invoice-message" style="height: 190px">
                    Dear Queen Consolidated,
                            Thank you for your business, always a pleasure to work with you!
                            We have generated a new invoice in the amount of $95.59
                            We would appreciate payment of this invoice by 05/11/2021</textarea
                                        >
                                <label for="invoice-message">Message</label>
                            </div>
                            <div class="mb-4">
                  <span class="badge bg-label-primary">
                    <i class="mdi mdi-link-variant mdi-14px me-1"></i>
                    <span class="align-middle">Invoice Attached</span>
                  </span>
                            </div>
                            <div class="mb-3 d-flex flex-wrap">
                                <button type="button" class="btn btn-primary me-3" data-bs-dismiss="offcanvas">
                                    Send
                                </button>
                                <button type="button" class="btn btn-label-secondary" data-bs-dismiss="offcanvas">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- /Send Invoice Sidebar -->

                <!-- Add Payment Sidebar -->
                <div class="offcanvas offcanvas-end" id="addPaymentOffcanvas" aria-hidden="true">
                    <div class="offcanvas-header mb-3">
                        <h5 class="offcanvas-title">Add Payment</h5>
                        <button
                                type="button"
                                class="btn-close text-reset"
                                data-bs-dismiss="offcanvas"
                                aria-label="Close"></button>
                    </div>
                    <div class="offcanvas-body flex-grow-1">
                        <div class="d-flex justify-content-between bg-lighter p-2 mb-3">
                            <p class="mb-0">Invoice Balance:</p>
                            <p class="fw-bold mb-0">$5000.00</p>
                        </div>
                        <form>
                            <div class="input-group input-group-merge mb-4">
                                <span class="input-group-text">$</span>
                                <div class="form-floating form-floating-outline">
                                    <input
                                            type="text"
                                            id="invoiceAmount"
                                            name="invoiceAmount"
                                            class="form-control invoice-amount"
                                            placeholder="100"/>
                                    <label for="invoiceAmount">Payment Amount</label>
                                </div>
                            </div>
                            <div class="form-floating form-floating-outline mb-4">
                                <input id="payment-date" class="form-control invoice-date" type="text"/>
                                <label for="payment-date">Payment Date</label>
                            </div>
                            <div class="form-floating form-floating-outline mb-4">
                                <select class="form-select" id="payment-method">
                                    <option value="" selected disabled>Select payment method</option>
                                    <option value="Cash">Cash</option>
                                    <option value="Bank Transfer">Bank Transfer</option>
                                    <option value="Debit Card">Debit Card</option>
                                    <option value="Credit Card">Credit Card</option>
                                    <option value="Paypal">Paypal</option>
                                </select>
                                <label for="payment-method">Payment Method</label>
                            </div>
                            <div class="form-floating form-floating-outline mb-4">
                                <textarea class="form-control" id="payment-note" style="height: 62px"></textarea>
                                <label for="payment-note">Internal Payment Note</label>
                            </div>
                            <div class="mb-3 d-flex flex-wrap">
                                <button type="button" class="btn btn-primary me-3" data-bs-dismiss="offcanvas">
                                    Send
                                </button>
                                <button type="button" class="btn btn-label-secondary" data-bs-dismiss="offcanvas">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- /Add Payment Sidebar -->

                <!-- /Offcanvas -->
            </div>
            <!-- / Content -->

            <!-- Footer -->
            <footer class="content-footer footer bg-footer-theme">
                <div class="container-xxl">
                    <div
                            class="footer-container d-flex align-items-center justify-content-between py-3 flex-md-row flex-column">
                        <div class="mb-2 mb-md-0">
                            ©
                            <script>
                                document.write(new Date().getFullYear());
                            </script>
                            <a href="https://asvignesh.in" target="_blank"
                               class="footer-link fw-medium">laserpoint</a>
                        </div>
                    </div>
                </div>
            </footer>
            <!-- / Footer -->

            <div class="content-backdrop fade"></div>
        </div>
        <!-- Content wrapper -->

    <script src="public/includes/js/popper.min.js"></script>
    <script src="public/includes/js/Chart.min.js"></script>
    <script src="public/includes/js/Chart.extension.js"></script>
    <script src="public/includes/js/jquery.min.js"></script>
    <script src="public/includes/js/bootstrap.bundle.min.js"></script>
    <script src="public/includes/js/argon.js"></script>
    <script src="public/includes/js/jquery.scrollbar.min.js"></script>
    <script src="public/includes/js/jquery-scrollLock.min.js"></script>
    <script src="public/includes/js/sweetalert.all.js"></script>
    <script src="public/includes/js/jquery.timepicker.js"></script>
    <script src="public/includes/js/common.js"></script>
    <script src="public/includes/js/jquery-repeater.js"></script>

    <!-- <script src="public/includes/js/invoice/invoice-add.js"></script> -->

    <script src="public/includes/js/map.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=" async defer></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.js"></script>


    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>

    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>

    <script type="text/javascript"
            src="https://cdn.datatables.net/v/bs4/jszip-2.5.0/dt-1.10.21/b-1.6.2/b-flash-1.6.2/b-html5-1.6.2/b-print-1.6.2/datatables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <script src="public/includes/js/myjavascript.js"></script>

    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>

    <!-- Core JS -->
<!-- build:js assets/vendor/js/core.js -->
<script src="assets/vendor/libs/jquery/jquery.js"></script>
<script src="assets/vendor/libs/popper/popper.js"></script>
<script src="assets/vendor/js/bootstrap.js"></script>
<script src="assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
<script src="assets/vendor/libs/node-waves/node-waves.js"></script>

<script src="assets/vendor/libs/hammer/hammer.js"></script>
<script src="assets/vendor/libs/i18n/i18n.js"></script>
<script src="assets/vendor/libs/typeahead-js/typeahead.js"></script>

<script src="assets/vendor/js/menu.js"></script>
<!-- endbuild -->

<!-- Vendors JS -->
<script src="assets/vendor/libs/flatpickr/flatpickr.js"></script>
<script src="assets/vendor/libs/cleavejs/cleave.js"></script>
<script src="assets/vendor/libs/cleavejs/cleave-phone.js"></script>
<script src="assets/vendor/libs/jquery-repeater/jquery-repeater.js"></script>

<!-- Main JS -->
<script src="assets/js/main.js"></script>

<!-- Plugins for Print and Download Functionality -->
<script src="assets/vendor/libs/jQuery.print/jQuery.print.js"></script>
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
    integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
></script>

<!-- Page JS -->
<!-- <script src="assets/js/offcanvas-send-invoice.js"></script> -->
<script src="assets/js/app-invoice-add.js"></script>
    
    <script type="module">
        $(document).ready(function () {
            var invoiceNum;
            var storeName;
            const discountData = {
                "STORE0": 0,
                "STORE50": 5,
                "STORE75": 7.5,
                "STORE100": 10,
                "STORE125": 12.5,
                "STORE150": 15
            }
            
            // var doc = new jsPDF(); 
            
            $("#body-content").load("dashboard.html");
            $("#navbar-left").load("inc/navbar.inc-admin.html");
            $("#navbar-top").load("inc/navbar-top-inc-admin.html", function () {
                // Set the initial content
                var selectedOption = $('#store').val();
                storeName = $(this).find(':selected').text();
                invoiceNum = JSON.parse(localStorage.getItem("invoiceData")).invoiceNumber;
                getInvoiceDetails()
                getStoreAddress(storeName);
                $('#store').on('change', function () {
                    storeName = $(this).find(':selected').text();
                    getStoreAddress(storeName);
                    getInvoiceDetails()
                });

                function getStoreAddress(storeName){
                    $.ajax({
                        url: baseUrl + 'stores/' + storeName,
                        method: 'GET',
                        headers: {
                            "Authorization": "Bearer " + bearerToken
                        },
                        success: function (response) {
                            console.log("Success");
                        },
                        error: function () {
                            console.log('Failed to fetch available numbers');
                        }
                    });
                }

                function getInvoiceDetails() {
                    $.ajax({
                        url: baseUrl + 'stores/' + storeName + '/invoice/' + invoiceNum,
                        method: 'GET',
                        data: { 
                            client: 'y', 
                            store: 'y', 
                            org: 'y'
                        },
                        headers: {
                            "Authorization": "Bearer " + bearerToken
                        },
                        success: function (invoiceData) {
                            const paymentMethod = JSON.parse(localStorage.getItem("paymentMethod"));
                            console.log("InvoiceDetails", invoiceData);
                            $('.custName').text(invoiceData.client.name);
                            $('.custMobile').text(invoiceData.clientMobile);
                            $('#storeName').text(invoiceData.storeName);
                            $('#storeAddress').text(invoiceData.store.address + ", " + invoiceData.store.phone);
                           // $('#customLogo').attr('src', invoiceData.store.org.logoUrl);
                            $('.invoiceNumber').text(invoiceData.invoiceNumber);
                            $('.invoiceDate').text(moment(invoiceData.createdAt).format('DD-MM-YYYY HH:mm'));
                            $('.basicSales').text(invoiceData.basicSales.toFixed(2));
                            $('.discountCoupons').text( invoiceData.coupons.join(", ") ? 'Discount ' + discountData[invoiceData.coupons.join(", ")] + '%' : 'Discount' );
                            $('.couponDiscount').text(invoiceData.couponDiscount.toFixed(2));
                            $('.membershipDiscount').text(invoiceData.membershipDiscount.toFixed(2));
                            $('.subTotal').text(invoiceData.subTotal.toFixed(2));
                            $('.netAmount').text(invoiceData.netAmount.toFixed(2));
                            $('.billAmount').text(Math.round(invoiceData.netAmount).toFixed(2));
                            $('.roundOff').text((Math.round(invoiceData.netAmount) - invoiceData.netAmount).toFixed(2));
                            $('.gstTin').text(invoiceData.store.tin);
                            $('.custCareEmail').text(invoiceData.store.org.email);
                            $('.storeCareNo').text(invoiceData.store.org.mobile);
                            $('.custCareNo').text(invoiceData.store.org.customerCareNumber);
                            $('.store-info').text(invoiceData.store.org.message);
                            $('.paymentMethod').text(paymentMethod.join(", "));

                            // Items Summary
                            const itemcontainer = $('.preview-items');
                            var totalQty = 0;
                            invoiceData.items.forEach(function(item) {
                                totalQty += item.itemQty;
                                var tr = $('<tr>');
                                tr.append('<td class="description">' + item.itemName + '</td>');
                                tr.append('<td class="quantity">' + item.itemQty + '</td>');
                                tr.append('<td class="rate">' + item.itemPrice.toFixed(2) + '</td>');
                                tr.append('<td class="price">' + (item.itemQty * item.itemPrice).toFixed(2) + '</td>');
                                itemcontainer.append(tr);
                                // if(item.serviceCharge) {
                                //     totalQty += 1;
                                //     var tr = $('<tr>');
                                //     tr.append('<td class="description">' + 'Service charge by Stylist' + '</td>');
                                //     tr.append('<td class="quantity">' + 1 + '</td>');
                                //     tr.append('<td class="rate">' + item.serviceCharge.toFixed(2) + '</td>');
                                //     tr.append('<td class="price">' + item.serviceCharge.toFixed(2) + '</td>');
                                //     itemcontainer.append(tr);
                                // }
                            });
                            var tr = $('<tr>');
                            tr.append('<th class="description">' + 'Total' + '</th>');
                            tr.append('<th class="quantity">' + totalQty + '</th>');
                            tr.append('<th colspan="2" class="price">' + invoiceData.basicSales.toFixed(2) + '</th>');
                            itemcontainer.append(tr);

                            // Discount Summary discountSummary
                            const discountcontainer = $('.discountSummary');

                            // Tax Summary 
                            var totalTax = 0;
                            const taxcontainer = $('.taxSummary');
                            invoiceData.taxSummary.forEach(function(tax) {
                                totalTax += tax.percentage;
                                var tr = $('<tr>');
                                tr.append('<td colspan="2" class="description">' + tax.name + ": " + tax.percentage + '%' + '</td>');
                                tr.append('<td colspan="2" class="price">' + tax.amount.toFixed(2) + '</td>');
                                taxcontainer.append(tr)
                            });
                            const gstcontainer = $('.previewGst');
                            gstcontainer.append('<td colspan="2" class="description">' + "GST" + '</td>');
                            gstcontainer.append('<td class="rate">' + totalTax + "%" + '</td>');
                            gstcontainer.append('<td class="price">' + invoiceData.tax.toFixed(2) + '</td>');
                            

                        },
                        error: function () {
                            console.log('Failed to fetch available numbers');
                        }
                    });
                    
                }
                 
                
            });

            var specialElementHandlers = {
                '#editor': function (element, renderer) {
                    return true;
                }
            };

            const button = document.getElementById("btnDownloadInvoive");

            function generatePDF() {
                console.log('Download triggered')
                // Choose the element that your content will be rendered to.
                const element = document.getElementById("receipt");

                var opt = {
                    margin:       [0, 0],
                    filename:     `invoice_${invoiceNum}.pdf`,
                    image:        { type: 'jpeg', quality: 0.98 },
                    html2canvas:  {
                        scale: 2,
                        y: 0,
                        x: 0,
                        scrollY: 0,
                        scrollX: 0,
                        windowWidth: 400,
                        height: element.offsetHeight,
                        width: element.offsetWidth,
                        dpi: 192,
                        letterRendering: true
                    },
                    jsPDF:        { unit: 'mm', format: [108, 210], orientation: 'portrait'}
                };
                
                // Choose the element and save the PDF for your user.
                html2pdf().set(opt).from(element).save();
            }

            button.addEventListener("click", generatePDF);

            $('#btnPrintInvoive').on('click', function() { 
                let data = {status: "printed"}

                $.print(".receipt");
                $.ajax({
                    url: baseUrl + 'stores/' + storeName + '/invoice/' + 19 + '/status',
                    method: 'PUT',
                    headers: {
                        "Authorization": "Bearer " + bearerToken
                    },
                    contentType: 'application/json',
                    data: JSON.stringify(data),
                    success: function (response) {
                        console.log("Success");
                        // window.location.href = "./invoice-add.html";
                    },
                    error: function () {
                        console.log('Failed to fetch available numbers');
                    }
                });

            });

            $('#btnCancelInvoive').on('click', function() { 
                let data = {status: "cancel"}

                $.ajax({
                    url: baseUrl + 'stores/' + storeName + '/invoice/' + 19 + '/status',
                    method: 'PUT',
                    headers: {
                        "Authorization": "Bearer " + bearerToken
                    },
                    contentType: 'application/json',
                    data: JSON.stringify(data),
                    success: function (response) {
                        console.log("Success");
                        window.location.href = "./invoice-add.html";
                    },
                    error: function () {
                        console.log('Failed to fetch available numbers');
                    }
                });
            });
        });
    </script>

    <!-- Argon JS -->
</div>
</body>

</html>